<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מעקב מבט - כן ולא מותאם לנייד</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin-top: 50px;
        }
        .button {
            font-size: 6vw; /* גודל רספונסיבי */
            padding: 5vw 10vw; /* התאמת הכפתורים למסכים קטנים */
            margin: 20px;
            border-radius: 10px;
            cursor: pointer;
            display: inline-block;
        }
        #yes-btn {
            background-color: lightgreen;
        }
        #no-btn {
            background-color: lightcoral;
        }
    </style>
</head>
<body>
    <h1 style="font-size: 6vw;">בחר על ידי מיקוד מבט: כן או לא?</h1>
    <button id="yes-btn" class="button">כן</button>
    <button id="no-btn" class="button">לא</button>

    <video id="cameraStream" width="1" height="1" autoplay style="display:none;"></video>

    <script>
        // פונקציה להשמעת פלט קולי
        function speak(text) {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'he-IL'; // שפה עברית
            window.speechSynthesis.speak(utterance);
        }

        // הפעלת מצלמה ושימוש ב-API של mediaDevices
        function startCamera() {
            const video = document.getElementById('cameraStream');
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function(stream) {
                    video.srcObject = stream;
                    console.log("המצלמה מופעלת בהצלחה.");
                })
                .catch(function(err) {
                    console.error("שגיאה בגישה למצלמה: " + err);
                    alert("לא ניתן לגשת למצלמה. אנא בדוק את ההרשאות.");
                });
        }

        // פונקציה לדימוי מעקב מבט
        function simulateGazeTracking() {
            // כאן אפשר להוסיף אלגוריתם מעקב מבט, אבל לצורך הדוגמה נשתמש במעקב מבוסס טיימר
            let lastFocusedButton = "";

            // מעקב מבוסס טיימר, בודק אחת לשנייה את הכפתורים
            setInterval(function() {
                // הגדרנו תנאי סימולציה שהמשתמש תמיד ממוקד בכפתור "כן"
                const yesBtn = document.getElementById('yes-btn');
                const noBtn = document.getElementById('no-btn');

                // סימולציה: נתמקד תמיד ב"כן"
                if (lastFocusedButton !== "כן") {
                    yesBtn.style.backgroundColor = 'green';
                    noBtn.style.backgroundColor = 'lightcoral';
                    speak("כן");
                    lastFocusedButton = "כן";
                }
            }, 1000); // מרווח של 1 שנייה לבדיקת מיקוד
        }

        window.onload = function() {
            startCamera(); // הפעלת מצלמה
            simulateGazeTracking(); // הפעלת סימולציית מעקב מבט
        };

        // ווידוא הפעלה של speech synthesis בספארי
        document.body.addEventListener('click', () => {
            if (window.speechSynthesis.paused) {
                window.speechSynthesis.resume();
            }
        });
    </script>
</body>
</html>
